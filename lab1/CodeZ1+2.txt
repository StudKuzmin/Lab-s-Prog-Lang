#include <iostream>
#include <string>
#include "stdio.h"
#include "fstream"
#include "ctime"
#include "math.h"

using namespace std;

int T1()//Задание 1
{
	int* m, f;

	f = rand() + 1;//Задаём неизвестное количество чисел 
	cout << "Количество чисел в файле: " << f << endl;
	m = new int[f];
	for (int i = 0; i < f; i++)
	{
		m[i] = rand() + 1;//Элементы массива не смогут принимать нулевое значение
	}

	ofstream file("C:\\Users\\MubaTwo\\Desktop\\Lab1\\GG.txt");//Запись в файл
	if (!file)
	{
		cout << "Ошибка открытия файла.";
	}

	else
	{
		cout << "\nФайл открыт.\n";
	}

	for (int i = 0; i < f; i++)//Сортируем неизвестное количество чисел в файле
	{
		for (int i = 0; i < f - 1; i++)
		{
			if (m[i] > m[i + 1])
			{
				swap(m[i], m[i + 1]);
			}
		}
	}

	for (int i = 0; i < f; i++)//Записываем в файл неизвестное количество чисел
	{
		file << m[i] << endl;
	}

	for (int i = 0; i < f; i++)
	{
		m[i] = 0;//Зануляем все элемента массива
	}

	ifstream file1("C:\\Users\\MubaTwo\\Desktop\\Lab1\\GG.txt");//Чтение файла
	if (!file1)
	{
		cout << "Ошибка чтения файла.";
	}

	else
	{
		cout << "\nФайл прочитан.\n\n";
	}

	for (int i = 0; i < f; i++)
	{
		file1 >> m[i];//Даём значение числа элементу массива
	}

	for (int i = 0; i < f; i++)//Выводим отсортированные числа на экран
	{
		printf("m[%d] > %d\n", i, m[i]);
	}

	file.close();
	file1.close();

	delete[] m;
	return 0;
}

int T2()//Задание 2
{
	int* m, a, b, g, k, n, size;

	cout << "Задайте интервал [a, b]:\n";
	cin >> a;
	cin >> b;

	size = fabs(a - (b + 1));//Размерность массива в связи с интервалом
	m = new int[size];

	printf("Заданный диапазон: [%d, %d]", a, b);

	for (int i = a, g = 0; i <= b; i++, g++)//Заполняем массив случайными числами из интервала
	{
		m[g] = a + rand() % ((b + 1) - a);
	}

	for (int i = 0; i < size; i++)
	{
		printf("\nm[%d] > %d\n", i, m[i]);
	}

	/*Сжатие массива*/

	cout << "\nEnter k: ";
	cin >> k;
	n = 0;


	for (int i = a, g = 0; i <= b; i++, g++)
	{
		if (m[g] > k)//Зануляем элементы массива, привышающие заданное число k
		{
			m[g] = 0;
		}
		else
		{
			printf("\nm[%d] > %d\n", g, m[g]);
			++n;
		}
	}

	for (int i = a; i <= b; i++)//Сортируем элементы массива по убыванию
	{
		for (int g = 0; g < b - 1; g++)
		{
			if (m[g] < m[g + 1])
			{
				swap(m[g], m[g + 1]);
			}
		}
	}

	size = n;//Сокращаем размер массива
	m = (int*)realloc(m, size * sizeof * m);//Сжатие массива
	cout << "\nСжатый массив:\n";

	for (int i = 0; i < size; i++)
	{
		printf("\nm[%d] > %d\n", i, m[i]);
	}

	delete[] m;
	return 0;
}

int main()
{
	setlocale(LC_ALL, "ru");
	srand(time(NULL));

	int n, z;
	cout << "Выберите задание 1-2: ";
	cin >> n;
	if (n < 1 || n > 2)
	{
		while (n < 1 || n > 2)
		{
			cout << "Выберите задание 1 или 2: ";
			cin >> n;
		}
	}

	if (n == 1)
	{
		T1();
	}
	if (n == 2)
	{
		T2();
	}

	return 0;
}